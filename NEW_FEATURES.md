# 🎯 新功能说明文档

## 功能一：文章目录（Table of Contents）

### ✨ 功能特性

1. **自动生成目录**
   - 自动检测文章中的所有标题（H2, H3, H4）
   - 生成层级化的目录结构
   - 支持点击跳转到对应章节

2. **智能高亮**
   - 使用 IntersectionObserver API 实现滚动监听
   - 当前阅读章节自动高亮显示
   - 高亮样式：青色文字 + 左侧边框 + 背景色

3. **阅读进度条**
   - 实时显示文章阅读进度（百分比）
   - 渐变色进度条（青色到紫色）
   - 平滑的动画过渡效果

4. **响应式设计**
   - 桌面端：右侧固定侧边栏
   - 移动端：浮动按钮 + 底部弹窗
   - 自适应不同屏幕尺寸

### 📍 实现位置

- **文件**: `_includes/toc.html`
- **集成**: 已添加到 `_layouts/post.html`
- **触发**: 文章页面自动生成

### 🎨 样式说明

```css
桌面端侧边栏:
- 位置: 固定在右侧（right-8）
- 宽度: 256px (w-64)
- 背景: 毛玻璃效果 + 半透明白色
- 边框: 渐变边框

移动端按钮:
- 位置: 右下角浮动
- 样式: 圆形渐变按钮
- 图标: 列表图标

活跃状态:
- 文字颜色: #06b6d4 (青色)
- 左侧边框: 2px 青色
- 背景: 青色 10% 透明
- 圆点: 青色 + 光晕效果
```

### 🔧 使用方法

#### 在文章中使用

文章自动生成目录，只需确保文章有标题：

```markdown
---
layout: post
title: "我的文章"
---

## 第一章

内容...

### 1.1 小节

内容...

## 第二章

内容...
```

#### 自定义配置

可以在 `_includes/toc.html` 中修改：

```javascript
// 修改标题选择器（包含哪些标题）
const headings = article.querySelectorAll('h2, h3, h4');

// 修改滚动偏移量
const offset = 100; // 距离顶部的像素

// 修改 IntersectionObserver 配置
const observerOptions = {
  rootMargin: '-100px 0px -66%',
  threshold: 0
};
```

### 📱 交互说明

**桌面端**:
- 目录固定在右侧
- 鼠标悬停显示手型光标
- 点击平滑滚动到章节
- 当前章节自动高亮

**移动端**:
- 点击右下角浮动按钮打开目录
- 目录以底部弹窗形式出现
- 点击章节后自动关闭弹窗
- 支持点击遮罩或关闭按钮关闭

---

## 功能二：分类与标签导航

### ✨ 功能特性

1. **三种视图模式**
   - **分类视图**: 卡片式展示所有分类
   - **标签视图**: 标签云展示所有标签
   - **全部文章**: 列表式展示所有文章

2. **实时搜索**
   - 支持搜索分类、标签、文章标题
   - 实时过滤，无需刷新
   - 空状态提示

3. **交互增强**
   - 点击分类/标签查看所有相关文章
   - 弹窗展示文章列表
   - 支持 ESC 键关闭弹窗

4. **视觉效果**
   - 卡片悬停动画（上浮 + 阴影）
   - 渐变背景效果
   - 科技感边框光效

### 📍 实现位置

- **文件**: `categories.html`
- **访问路径**: `/categories/`
- **导航链接**: 已添加到顶部导航栏

### 🎨 视图说明

#### 分类视图

```
┌─────────────────────────────────┐
│ 卡片式布局（3列网格）            │
│                                 │
│ ┌───────┐ ┌───────┐ ┌───────┐  │
│ │ 分类1 │ │ 分类2 │ │ 分类3 │  │
│ │ 5篇   │ │ 3篇   │ │ 8篇   │  │
│ │ • 文章│ │ • 文章│ │ • 文章│  │
│ └───────┘ └───────┘ └───────┘  │
└─────────────────────────────────┘
```

**特点**:
- 每个分类显示前3篇文章
- 显示文章数量
- 渐变图标
- 悬停效果：上浮 + 阴影 + 底部光条

#### 标签视图

```
┌─────────────────────────────────┐
│ 标签云（自动换行）               │
│                                 │
│ [#Jekyll 5] [#CSS 3] [#JS 8]   │
│ [#React 2] [#Vue 4] [#Node 6]  │
│ [#Python 7] [#Java 3]           │
└─────────────────────────────────┘
```

**特点**:
- 圆角标签设计
- 显示文章数量徽章
- 悬停效果：缩放 + 渐变背景 + 阴影
- 点击显示相关文章

#### 全部文章视图

```
┌─────────────────────────────────┐
│ 列表式布局                       │
│                                 │
│ 📄 文章标题 1        [分类] #标签│
│    2025-01-15                   │
│                                 │
│ 📄 文章标题 2        [分类] #标签│
│    2025-01-10                   │
└─────────────────────────────────┘
```

**特点**:
- 文档图标
- 日期显示
- 分类和标签标记
- 悬停效果：背景变化 + 箭头移动

### 🔍 搜索功能

**搜索范围**:
- 分类名称
- 标签名称
- 文章标题

**搜索逻辑**:
```javascript
// 实时过滤，不区分大小写
filterValue.toLowerCase()
// 匹配任意位置的文字
includes(filterValue)
```

**空状态**:
- 显示搜索图标
- 提示文字：没有找到匹配的内容
- 建议尝试其他关键词

### 🎯 弹窗功能

**触发条件**:
- 点击分类卡片的"查看全部"按钮
- 点击标签标签

**弹窗内容**:
- 标题：分类/标签名称 + 文章数量
- 列表：该分类/标签下的所有文章
- 关闭按钮

**关闭方式**:
- 点击关闭按钮 (X)
- 点击弹窗外部遮罩
- 按 ESC 键

### 📱 响应式适配

**桌面端 (>1024px)**:
- 分类：3列网格布局
- 标签：多行自动换行
- 文章：完整信息显示

**平板端 (768px-1024px)**:
- 分类：2列网格布局
- 标签：自适应换行
- 文章：简化信息显示

**移动端 (<768px)**:
- 分类：1列布局
- 标签：流式布局
- 文章：堆叠显示

### 🎨 颜色方案

```css
主色调:
- 青色: #06b6d4 (tech-cyan)
- 紫色: #8b5cf6 (tech-purple)

背景:
- 卡片: rgba(255, 255, 255, 0.05)
- 悬停: rgba(6, 182, 212, 0.05)

边框:
- 默认: rgba(255, 255, 255, 0.1)
- 悬停: rgba(6, 182, 212, 0.5)

文字:
- 标题: #ffffff
- 正文: #d1d5db
- 次要: #9ca3af
```

### 🔧 自定义配置

#### 修改分类卡片显示的文章数量

在 `categories.html` 中：

```liquid
{%- for post in category[1] limit:3 -%}
<!-- 修改 limit 值来改变显示数量 -->
```

#### 修改视图切换按钮

在 `categories.html` 中找到标签切换部分，可以：
- 添加新的视图
- 修改按钮文字和图标
- 调整按钮样式

#### 添加更多过滤条件

在 `filterContent()` 函数中添加：

```javascript
const excerpt = card.dataset.excerpt; // 需要先在 HTML 中添加 data-excerpt
if (excerpt.includes(filterValue)) {
  // ...
}
```

---

## 🚀 使用示例

### 示例1：查看文章目录

1. 打开任意文章页面
2. 桌面端：右侧自动显示目录
3. 移动端：点击右下角浮动按钮
4. 点击目录项跳转到对应章节
5. 滚动时观察当前章节高亮效果

### 示例2：按分类浏览

1. 点击导航栏"分类"链接
2. 进入分类页面，默认显示分类视图
3. 浏览不同分类卡片
4. 点击"查看全部"查看该分类所有文章
5. 在弹窗中点击文章标题跳转

### 示例3：搜索文章

1. 在分类页面顶部搜索框输入关键词
2. 实时过滤显示匹配的内容
3. 切换不同视图查看搜索结果
4. 清空搜索框恢复所有内容

---

## 📊 技术实现

### 文章目录 (TOC)

**核心技术**:
- JavaScript IntersectionObserver API
- Smooth Scroll API
- Dynamic DOM Generation

**关键函数**:
```javascript
generateTOC()           // 生成目录
scrollToHeading()       // 跳转到章节
initScrollSpy()         // 初始化滚动监听
updateReadingProgress() // 更新阅读进度
```

### 分类标签导航

**核心技术**:
- Jekyll Liquid 模板
- JavaScript 动态过滤
- CSS Grid & Flexbox 布局
- CSS 渐变动画

**关键函数**:
```javascript
showTab()           // 切换视图
filterContent()     // 过滤内容
showCategoryPosts() // 显示分类文章
showTagPosts()      // 显示标签文章
closeModal()        // 关闭弹窗
```

---

## 🎨 设计理念

### 视觉设计

**关键词**: 科技感、简约、大气、渐变、光效

**设计元素**:
- 毛玻璃背景（backdrop-blur）
- 渐变色彩（青色到紫色）
- 微妙阴影和光晕
- 平滑过渡动画

### 交互设计

**原则**:
- 响应快速（< 300ms）
- 反馈明确（视觉变化）
- 操作简单（一键直达）
- 容错性强（多种关闭方式）

---

## ✅ 兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+
- ⚠️ IE 不支持（IntersectionObserver）

---

## 🐛 故障排除

### TOC 不显示

**检查**:
1. 文章是否有 H2/H3/H4 标题
2. 是否使用了 `post` 布局
3. 浏览器控制台是否有错误

**解决**:
- 确保文章有标题
- 检查 `_includes/toc.html` 是否正确引入
- 清除浏览器缓存

### 搜索不工作

**检查**:
1. JavaScript 是否被禁用
2. 控制台是否有错误
3. 数据属性是否正确设置

**解决**:
- 启用 JavaScript
- 检查 `categories.html` 中的 data 属性
- 重新构建 Jekyll 站点

### 样式错乱

**检查**:
1. Tailwind CSS 是否加载
2. 自定义 CSS 是否冲突
3. 浏览器缓存

**解决**:
- 强制刷新（Ctrl+Shift+R）
- 检查 CSS 加载顺序
- 清除浏览器缓存

---

## 🎓 总结

两个新功能已完美集成到你的 Jekyll 博客中：

✅ **文章目录**：提升阅读体验，智能导航
✅ **分类标签**：优化内容发现，便捷浏览

**特点**：
- 🎨 科技感十足的视觉设计
- 📱 完美的响应式适配
- ⚡ 流畅的交互动画
- 🔧 灵活的自定义配置

**享受你的新功能吧！** 🚀✨
